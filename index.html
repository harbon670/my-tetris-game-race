    // ... (весь HTML и стили из предыдущего ответа) ...

    let score = 0;
    let gameSpeed = 1.6; 
    let gameOver = false;
    let playerX = LANE_LEFT;
    let targetX = LANE_LEFT;
    let enemies = [];
    let lastSpawn = 0;
    let nextSpawnDelay = 2000; // Переменная задержка

    const carMatrix = [[0,1,0],[1,1,1],[0,1,0],[1,0,1]];
    const truckMatrix = [[1,1,1],[1,1,1],[1,1,1],[1,1,1],[1,0,1]]; // Короткая фура

    // ... (функции drawEntity и resetGame такие же) ...

    function loop() {
      if (gameOver) return;
      requestAnimationFrame(loop);
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Отрисовка разметки (для ощущения движения)
      ctx.strokeStyle = "#222";
      ctx.setLineDash([20, 20]);
      ctx.lineDashOffset = -(Date.now() / (20/gameSpeed));
      ctx.beginPath();
      ctx.moveTo(canvas.width/2, 0); ctx.lineTo(canvas.width/2, canvas.height);
      ctx.stroke();

      playerX += (targetX - playerX) * 0.15;
      drawEntity(playerX, 14, carMatrix, "#0ff");

      let now = Date.now();
      // ЛОГИКА ШАШЕК
      if (now - lastSpawn > nextSpawnDelay / (gameSpeed / 1.5)) {
        let lastX = enemies.length > 0 ? enemies[enemies.length-1].x : null;
        let newX;
        
        // С шансом 70% ставим машину на противоположную сторону от предыдущей (шашки)
        if (lastX && Math.random() < 0.7) {
          newX = (lastX === LANE_LEFT) ? LANE_RIGHT : LANE_LEFT;
          nextSpawnDelay = 600 + Math.random() * 800; // Быстрая перекладка
        } else {
          newX = Math.random() > 0.5 ? LANE_LEFT : LANE_RIGHT;
          nextSpawnDelay = 1500 + Math.random() * 1000; // Длинное окно
        }

        enemies.push({ 
          x: newX, 
          y: -6, 
          type: Math.random() < 0.2 ? 'truck' : 'car' 
        });
        lastSpawn = now;
      }

      for (let i = enemies.length - 1; i >= 0; i--) {
        let e = enemies[i];
        let matrix = e.type === 'truck' ? truckMatrix : carMatrix;
        
        e.y += gameSpeed / 25; 
        drawEntity(e.x, e.y, matrix, e.type === 'truck' ? "#ffaa00" : "#ff0055");
        
        // Коллизия (с запасом на узкие места)
        if (!(playerX + 1.8 < e.x || playerX > e.x + 1.8 || 14 + 3.2 < e.y || 14 > e.y + (matrix.length - 0.8))) {
          gameOver = true;
        }

        if (e.y > 20) {
          enemies.splice(i, 1);
          score += 10;
          scoreEl.innerText = "SCORE: " + score;
          if (score % 100 === 0 && gameSpeed < 6) gameSpeed += 0.2;
        }
      }

      if (gameOver) {
        // ... (отрисовка Game Over как раньше) ...
      }
    }
    loop();
